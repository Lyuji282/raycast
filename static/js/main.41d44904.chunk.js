(this.webpackJsonpraycast=this.webpackJsonpraycast||[]).push([[0],{13:function(t,e,n){t.exports=n(26)},25:function(t,e,n){},26:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),o=n(5),a=n.n(o),c=n(1);function s(t,e){this.x=t,this.y=e}function h(t){this.height=t,this.size=10,this.grid=[[1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,0,0,0,0,1,0,1,0,1],[1,0,0,0,0,1,1,1,0,1],[1,0,1,0,0,0,0,0,0,1],[1,0,1,1,0,0,0,0,0,1],[1,0,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]}function u(t,e){return new s(Math.floor(t.x/e),Math.floor(t.y/e))}s.prototype.add=function(t,e){return new s(this.x+t,this.y+e)},s.prototype.distance=function(t){return Math.hypot(this.x-t.x,this.y-t.y)},h.prototype.isWall=function(t){var e=u(t,this.height);return this.isWithinBounds(t)&&1===this.grid[e.y][e.x]},h.prototype.isWithinBounds=function(t){var e=u(t,this.height);return e.x>=0&&e.x<this.size&&e.y>=0&&e.y<this.size};var l=n(6),f=n(7),p=n(11),d=n(8),y=n(12),b=2*Math.PI;function g(t){return t*Math.PI/180}var v=function(t){function e(){var t,n;Object(l.a)(this,e);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(n=Object(p.a)(this,(t=Object(d.a)(e)).call.apply(t,[this].concat(o)))).wallsRef=r.a.createRef(),n.playerRef=r.a.createRef(),n.raysRef=r.a.createRef(),n}return Object(y.a)(e,t),Object(f.a)(e,[{key:"componentDidMount",value:function(){this.drawWalls(),this.drawPlayer(),this.drawRays()}},{key:"drawWalls",value:function(){var t=this.wallsRef.current.getContext("2d"),e=this.props,n=e.map,i=e.size/n.size;t.fillStyle="blue",n.grid.forEach((function(e,n){e.forEach((function(e,r){1===e&&t.fillRect(r*i,n*i,i,i)}))}))}},{key:"drawPlayer",value:function(){var t=this.playerRef.current.getContext("2d"),e=this.props,n=e.map,i=e.player,r=e.size,o=i.position,a=o.x/n.height,c=o.y/n.height,s=r/n.size,h=a*s,u=c*s;t.clearRect(0,0,r,r),t.fillStyle="green",t.beginPath(),t.arc(h,u,5,0,b),t.fill()}},{key:"drawRays",value:function(){var t=this.raysRef.current.getContext("2d"),e=this.props,n=e.map,i=e.rays,r=e.size,o=r/n.size;t.clearRect(0,0,r,r),t.beginPath(),t.strokeStyle="green";for(var a=0;a<i.length;a+=16){var c=i[a],s=c.angle,h=c.distance,u=c.origin,l=u.x/n.height,f=u.y/n.height,p=h/n.height,d=l*o,y=f*o,b=r/n.size*p;t.moveTo(d,y),t.lineTo(d+b*Math.cos(s),y+b*-Math.sin(s)),t.stroke()}}},{key:"componentDidUpdate",value:function(t){t.rays!==this.props.rays&&(this.drawPlayer(),this.drawRays())}},{key:"render",value:function(){var t=this.props.size;return r.a.createElement("div",{style:m.container},r.a.createElement("canvas",{ref:this.wallsRef,height:t,width:t,style:m.layer}),r.a.createElement("canvas",{ref:this.playerRef,height:t,width:t,style:m.layer}),r.a.createElement("canvas",{ref:this.raysRef,height:t,width:t,style:m.layer}))}}]),e}(r.a.Component),m={container:{position:"relative"},layer:{position:"absolute",top:0,left:0}};function O(t,e,n){this.origin=n,this.angle=function(t){var e=t%b;return e<0?e+b:e}(e),this.distance=function(t,e,n){var i=e>0&&e<Math.PI,r=e<.25*b||e>.75*b,o=function(t,e,n,i,r){var o=Math.floor(e.y/t.height)*t.height+(i?-.01:t.height),a=new s(e.x+(e.y-o)/Math.tan(n),o),c=i?-t.height:t.height,h=Math.abs(t.height/Math.tan(n))*(r?1:-1);return w(t,a,h,c).distance(e)}(t,n,e,i,r),a=function(t,e,n,i,r){var o=Math.floor(e.x/t.height)*t.height+(r?t.height:-.01),a=e.y+(e.x-o)*Math.tan(n),c=new s(o,a),h=r?t.height:-t.height,u=Math.abs(t.height*Math.tan(n))*(i?-1:1);return w(t,c,h,u).distance(e)}(t,n,e,i,r);return Math.min(o,a)}(t,this.angle,n)}function w(t,e,n,i){return t.isWithinBounds(e)?t.isWall(e)?e:w(t,e.add(n,i),n,i):new s(1/0,1/0)}function j(t,e,n){this.position=new s(t,e),this.direction=n}function k(t,e,n){return t.isWall(e)?0:n}j.prototype.castRays=function(t,e,n){var i=this,r=e/n,o=this.direction+e/2;return new Array(n).fill(0).map((function(t,e){return o-e*r})).map((function(e){return new O(t,e,i.position)}))},j.prototype.turnRight=function(t){this.direction-=.025*t/16},j.prototype.turnLeft=function(t){this.direction+=.025*t/16},j.prototype.moveForward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(k(t,this.position.add(n,0),n),k(t,this.position.add(0,-i),-i))},j.prototype.moveBackward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(k(t,this.position.add(-n,0),-n),k(t,this.position.add(0,i),i))},j.prototype.moveLeft=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(k(t,this.position.add(n,0),n),k(t,this.position.add(0,-i),-i))},j.prototype.moveRight=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(k(t,this.position.add(-n,0),-n),k(t,this.position.add(0,i),i))};var E=n(2),M=n(9),R=n.n(M);function P(t){var e=t.color,n=t.distance,i=t.mapHeight,o=t.number,a=t.resolution,c=t.screenHeight,s=t.screenWidth,h=Math.min(i/n*255,c),u=s/a,l=(c-h)/2,f={backgroundColor:R()(e).darken(n/460).hex(),height:h,left:o*u,width:u,position:"absolute",top:l};return r.a.createElement("div",{style:f})}function x(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function z(t){var e=t.height,n=t.mapHeight,o=t.player,a=t.rays,c=t.resolution,s=t.width,h=Object(i.useMemo)((function(){return function(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?x(Object(n),!0).forEach((function(e){Object(E.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):x(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}({},C.container,{height:e,width:s})}),[e,s]);return r.a.createElement("div",{style:h},r.a.createElement("div",{style:C.ceiling}),r.a.createElement("div",{style:C.floor}),a.map((function(t,i){return r.a.createElement(P,{color:"#0000FF",distance:S(t,o),key:i,mapHeight:n,number:i,resolution:c,screenHeight:e,screenWidth:s})})))}function S(t,e){return t.distance*Math.cos(t.angle-e.direction)}var C={container:{border:"1px solid black",position:"relative"},ceiling:{backgroundColor:"SlateGrey",position:"absolute",left:0,right:0,bottom:"50%",top:0},floor:{backgroundColor:"Gainsboro",position:"absolute",left:0,right:0,bottom:0,top:"50%"}},D=n(10),W=n.n(D);function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,i)}return n}function F(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(Object(n),!0).forEach((function(e){Object(E.a)(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function I(t,e){switch(e.type){case"down":return F({},t,Object(E.a)({},e.key,!0));case"up":return F({},t,Object(E.a)({},e.key,!1));default:return t}}function A(t,e){var n=e.andThen,r=void 0===n?function(){}:n,o=function(t,e){var n=Object(i.useReducer)(t,e),r=Object(c.a)(n,2),o=r[0],a=r[1],s=Object(i.useRef)(o);return Object(i.useEffect)((function(){s.current=o}),[o]),[s,a]}(I,{}),a=Object(c.a)(o,2),s=a[0],h=a[1];!function(t){var e=Object(i.useRef)(),n=Object(i.useRef)();Object(i.useEffect)((function(){n.current=window.performance.now()}),[]),Object(i.useEffect)((function(){return e.current=requestAnimationFrame((function i(r){e.current=requestAnimationFrame(i),t(r-n.current),n.current=r})),function(){return cancelAnimationFrame(e.current)}}),[t])}(Object(i.useCallback)((function(e){var n=!1;W()(t,(function(t,i){s.current[i]&&(n=!0,t(e))})),n&&r()}),[s,t,r])),Object(i.useEffect)((function(){var e=Object.keys(t);function n(t){e.includes(t.key)&&h({type:"down",key:t.key})}function i(t){e.includes(t.key)&&h({type:"up",key:t.key})}return document.addEventListener("keydown",n),document.addEventListener("keyup",i),function(){document.removeEventListener("keydown",n),document.removeEventListener("keyup",i)}}),[t,h])}var B=g(60),H=new h(64),T=new j(160,160,g(0)),q=320;var G={container:{display:"flex"}};n(25);a.a.render(r.a.createElement((function(){var t=Object(i.useState)(!0),e=Object(c.a)(t,2),n=e[0],o=e[1],a=function(t,e,n,r){var o=Object(i.useState)([]),a=Object(c.a)(o,2),s=a[0],h=a[1],u=Object(i.useCallback)((function(){var i=t.castRays(e,n,r);h(i)}),[t,e,n,r]);return Object(i.useEffect)((function(){u()}),[u]),A(Object(i.useMemo)((function(){return{w:function(n){t.moveForward(e,n)},s:function(n){t.moveBackward(e,n)},a:function(n){t.moveLeft(e,n)},d:function(n){t.moveRight(e,n)},ArrowLeft:function(e){t.turnLeft(e)},ArrowRight:function(e){t.turnRight(e)}}}),[t,e]),{andThen:u}),s}(T,H,B,q);return r.a.createElement("div",{style:G.container},r.a.createElement("div",null,r.a.createElement(z,{height:400,mapHeight:H.height,player:T,rays:a,resolution:q,width:740}),r.a.createElement("div",null,r.a.createElement("span",null,"Move using the w, s, a, d, \u2190, and \u2192 keys"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"show_minimap"},"Show minimap",r.a.createElement("input",{id:"show_minimap",onChange:function(){return o(!n)},type:"checkbox",checked:n}))),r.a.createElement("a",{href:"https://github.com/ahuth/raycast"},"Source code"))),n&&r.a.createElement(v,{fov:B,map:H,player:T,rays:a,resolution:q,size:300}))})),document.getElementById("root"))}},[[13,1,2]]]);
//# sourceMappingURL=main.41d44904.chunk.js.map