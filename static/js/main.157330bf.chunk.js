(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{14:function(t,e,n){t.exports=n(28)},27:function(t,e,n){},28:function(t,e,n){"use strict";n.r(e);var i=n(0),r=n.n(i),a=n(6),o=n.n(a),s=n(1);function c(t,e){this.x=t,this.y=e}function h(t){this.height=t,this.size=10,this.grid=[[1,1,1,1,1,1,1,1,1,1],[1,0,0,0,0,0,0,0,0,1],[1,0,0,0,1,1,1,1,0,1],[1,0,0,0,0,0,0,1,0,1],[1,0,0,0,0,1,0,1,0,1],[1,0,0,0,0,1,1,1,0,1],[1,0,1,0,0,0,0,0,0,1],[1,0,1,1,0,0,0,0,0,1],[1,0,1,1,1,0,0,0,0,1],[1,1,1,1,1,1,1,1,1,1]]}function u(t,e){return new c(Math.floor(t.x/e),Math.floor(t.y/e))}c.prototype.add=function(t,e){return new c(this.x+t,this.y+e)},c.prototype.distance=function(t){return Math.hypot(this.x-t.x,this.y-t.y)},h.prototype.isWall=function(t){var e=u(t,this.height);return this.isWithinBounds(t)&&1===this.grid[e.y][e.x]},h.prototype.isWithinBounds=function(t){var e=u(t,this.height);return e.x>=0&&e.x<this.size&&e.y>=0&&e.y<this.size};var l=n(7),d=n(8),f=n(12),p=n(9),y=n(13),m=2*Math.PI;function v(t){return t*Math.PI/180}var g=function(t){function e(){var t,n;Object(l.a)(this,e);for(var i=arguments.length,a=new Array(i),o=0;o<i;o++)a[o]=arguments[o];return(n=Object(f.a)(this,(t=Object(p.a)(e)).call.apply(t,[this].concat(a)))).wallsRef=r.a.createRef(),n.playerRef=r.a.createRef(),n.raysRef=r.a.createRef(),n}return Object(y.a)(e,t),Object(d.a)(e,[{key:"componentDidMount",value:function(){this.drawWalls(),this.drawPlayer(),this.drawRays()}},{key:"drawWalls",value:function(){var t=this.wallsRef.current.getContext("2d"),e=this.props,n=e.map,i=e.size/n.size;t.fillStyle="blue",n.grid.forEach(function(e,n){e.forEach(function(e,r){1===e&&t.fillRect(r*i,n*i,i,i)})})}},{key:"drawPlayer",value:function(){var t=this.playerRef.current.getContext("2d"),e=this.props,n=e.map,i=e.player,r=e.size,a=i.position,o=a.x/n.height,s=a.y/n.height,c=r/n.size,h=o*c,u=s*c;t.clearRect(0,0,r,r),t.fillStyle="green",t.beginPath(),t.arc(h,u,5,0,m),t.fill()}},{key:"drawRays",value:function(){var t=this.raysRef.current.getContext("2d"),e=this.props,n=e.map,i=e.rays,r=e.size,a=r/n.size;t.clearRect(0,0,r,r),t.beginPath(),t.strokeStyle="green";for(var o=0;o<i.length;o+=16){var s=i[o],c=s.angle,h=s.distance,u=s.origin,l=u.x/n.height,d=u.y/n.height,f=h/n.height,p=l*a,y=d*a,m=r/n.size*f;t.moveTo(p,y),t.lineTo(p+m*Math.cos(c),y+m*-Math.sin(c)),t.stroke()}}},{key:"componentDidUpdate",value:function(t){t.rays!==this.props.rays&&(this.drawPlayer(),this.drawRays())}},{key:"render",value:function(){var t=this.props.size;return r.a.createElement("div",{style:b.container},r.a.createElement("canvas",{ref:this.wallsRef,height:t,width:t,style:b.layer}),r.a.createElement("canvas",{ref:this.playerRef,height:t,width:t,style:b.layer}),r.a.createElement("canvas",{ref:this.raysRef,height:t,width:t,style:b.layer}))}}]),e}(r.a.Component),b={container:{position:"relative"},layer:{position:"absolute",top:0,left:0}};function w(t,e,n){this.origin=n,this.angle=function(t){var e=t%m;return e<0?e+m:e}(e),this.distance=function(t,e,n){var i=e>0&&e<Math.PI,r=e<.25*m||e>.75*m,a=function(t,e,n,i,r){var a=Math.floor(e.y/t.height)*t.height+(i?-.01:t.height),o=new c(e.x+(e.y-a)/Math.tan(n),a),s=i?-t.height:t.height,h=Math.abs(t.height/Math.tan(n))*(r?1:-1);return k(t,o,h,s).distance(e)}(t,n,e,i,r),o=function(t,e,n,i,r){var a=Math.floor(e.x/t.height)*t.height+(r?t.height:-.01),o=e.y+(e.x-a)*Math.tan(n),s=new c(a,o),h=r?t.height:-t.height,u=Math.abs(t.height*Math.tan(n))*(i?-1:1);return k(t,s,h,u).distance(e)}(t,n,e,i,r);return Math.min(a,o)}(t,this.angle,n)}function k(t,e,n,i){return t.isWithinBounds(e)?t.isWall(e)?e:k(t,e.add(n,i),n,i):new c(1/0,1/0)}function M(t,e,n){this.position=new c(t,e),this.direction=n}function E(t,e,n){return t.isWall(e)?0:n}M.prototype.castRays=function(t,e,n){var i=this,r=e/n,a=this.direction+e/2;return new Array(n).fill(0).map(function(t,e){return a-e*r}).map(function(e){return new w(t,e,i.position)})},M.prototype.turnRight=function(t){this.direction-=.025*t/16},M.prototype.turnLeft=function(t){this.direction+=.025*t/16},M.prototype.moveForward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(E(t,this.position.add(n,0),n),E(t,this.position.add(0,-i),-i))},M.prototype.moveBackward=function(t,e){var n=e/16*1.4*Math.cos(this.direction),i=e/16*1.4*Math.sin(this.direction);this.position=this.position.add(E(t,this.position.add(-n,0),-n),E(t,this.position.add(0,i),i))},M.prototype.moveLeft=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(E(t,this.position.add(n,0),n),E(t,this.position.add(0,-i),-i))},M.prototype.moveRight=function(t,e){var n=e/16*1.4*Math.cos(this.direction+Math.PI/2),i=e/16*1.4*Math.sin(this.direction+Math.PI/2);this.position=this.position.add(E(t,this.position.add(-n,0),-n),E(t,this.position.add(0,i),i))};var j=n(2),O=n(10),R=n.n(O);function x(t){var e=t.color,n=t.distance,i=t.mapHeight,a=t.number,o=t.resolution,s=t.screenHeight,c=t.screenWidth,h=Math.min(i/n*255,s),u=c/o,l=(s-h)/2,d={backgroundColor:R()(e).darken(n/460).hex(),height:h,left:a*u,width:u,position:"absolute",top:l};return r.a.createElement("div",{style:d})}function z(t){var e=t.height,n=t.mapHeight,a=t.player,o=t.rays,s=t.resolution,c=t.width,h=Object(i.useMemo)(function(){return Object(j.a)({},C.container,{height:e,width:c})},[e,c]);return r.a.createElement("div",{style:h},r.a.createElement("div",{style:C.ceiling}),r.a.createElement("div",{style:C.floor}),o.map(function(t,i){return r.a.createElement(x,{color:"#0000FF",distance:P(t,a),key:i,mapHeight:n,number:i,resolution:s,screenHeight:e,screenWidth:c})}))}function P(t,e){return t.distance*Math.cos(t.angle-e.direction)}var C={container:{border:"1px solid black",position:"relative"},ceiling:{backgroundColor:"SlateGrey",position:"absolute",left:0,right:0,bottom:"50%",top:0},floor:{backgroundColor:"Gainsboro",position:"absolute",left:0,right:0,bottom:0,top:"50%"}},W=n(3),L=n(11),F=n.n(L);function I(t,e){switch(e.type){case"down":return Object(j.a)({},t,Object(W.a)({},e.key,!0));case"up":return Object(j.a)({},t,Object(W.a)({},e.key,!1));default:return t}}function S(t,e){var n=e.andThen,r=void 0===n?function(){}:n,a=function(t,e){var n=Object(i.useReducer)(t,e),r=Object(s.a)(n,2),a=r[0],o=r[1],c=Object(i.useRef)(a);return Object(i.useEffect)(function(){c.current=a},[a]),[c,o]}(I,{}),o=Object(s.a)(a,2),c=o[0],h=o[1];!function(t){var e=Object(i.useRef)(),n=Object(i.useRef)();Object(i.useEffect)(function(){n.current=window.performance.now()},[]),Object(i.useEffect)(function(){return e.current=requestAnimationFrame(function i(r){e.current=requestAnimationFrame(i),t(r-n.current),n.current=r}),function(){return cancelAnimationFrame(e.current)}},[t])}(Object(i.useCallback)(function(e){var n=!1;F()(t,function(t,i){c.current[i]&&(n=!0,t(e))}),n&&r()},[c,t,r])),Object(i.useEffect)(function(){var e=Object.keys(t);function n(t){e.includes(t.key)&&h({type:"down",key:t.key})}function i(t){e.includes(t.key)&&h({type:"up",key:t.key})}return document.addEventListener("keydown",n),document.addEventListener("keyup",i),function(){document.removeEventListener("keydown",n),document.removeEventListener("keyup",i)}},[t,h])}var A=v(60),B=new h(64),H=new M(160,160,v(0)),T=320;var q={container:{display:"flex"}};n(27);o.a.render(r.a.createElement(function(){var t=Object(i.useState)(!0),e=Object(s.a)(t,2),n=e[0],a=e[1],o=function(t,e,n,r){var a=Object(i.useState)([]),o=Object(s.a)(a,2),c=o[0],h=o[1],u=Object(i.useCallback)(function(){var i=t.castRays(e,n,r);h(i)},[t,e,n,r]);return Object(i.useEffect)(function(){u()},[u]),S(Object(i.useMemo)(function(){return{w:function(n){t.moveForward(e,n)},s:function(n){t.moveBackward(e,n)},a:function(n){t.moveLeft(e,n)},d:function(n){t.moveRight(e,n)},ArrowLeft:function(e){t.turnLeft(e)},ArrowRight:function(e){t.turnRight(e)}}},[t,e]),{andThen:u}),c}(H,B,A,T);return r.a.createElement("div",{style:q.container},r.a.createElement("div",null,r.a.createElement(z,{height:400,mapHeight:B.height,player:H,rays:o,resolution:T,width:740}),r.a.createElement("div",null,r.a.createElement("span",null,"Move using the w, s, a, d, \u2190, and \u2192 keys"),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"show_minimap"},"Show minimap",r.a.createElement("input",{id:"show_minimap",onChange:function(){return a(!n)},type:"checkbox",checked:n}))),r.a.createElement("a",{href:"https://github.com/ahuth/raycast"},"Source code"))),n&&r.a.createElement(g,{fov:A,map:B,player:H,rays:o,resolution:T,size:300}))}),document.getElementById("root"))}},[[14,1,2]]]);
//# sourceMappingURL=main.157330bf.chunk.js.map